generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model user {
    id              String   @id @default(uuid()) @db.Uuid
    name            String?
    email           String   @unique
    password        String?
    personifikasi   String?
    image           String?
    role            String @default("user")
    createdat       DateTime @default(now())
    updatedat       DateTime @updatedAt

    accounts        account[]
    sessions        session[]
    conversations   conversations[]
}

model account {
    id                 String  @id @default(uuid()) @db.Uuid
    userid             String  @db.Uuid
    type               String
    provider           String
    provideraccountid  String
    refresh_token      String? 
    access_token       String? 
    expires_at         Int?    
    token_type         String? 
    scope              String? 
    id_token           String? 
    session_state      String? 

    user user @relation(fields: [userid], references: [id])
    @@unique([provider, provideraccountid])
}

model session {
    id           String   @id @default(uuid()) @db.Uuid
    sessiontoken String   @unique
    userid       String   @db.Uuid
    expires      DateTime

    user user @relation(fields: [userid], references: [id])
}

model VerificationToken {
    identifier String
    token      String   @unique
    expires    DateTime

    @@unique([identifier, token])
}

model conversations {
  id                String @id @default(uuid()) @db.Uuid
  userid            String @db.Uuid
  title             String?
  createdat         DateTime @default(now())
  updatedat         DateTime? @updatedAt
  
  messages          messages[]

  user user @relation(fields: [userid], references: [id])
}

model messages {
  id                String @id @default(uuid()) @db.Uuid
  conversationid    String @db.Uuid
  role              String
  message           String
  selectedmodel     String
  responsetime      Int?
  inputtoken        Int?
  outputtoken       Int?
  created_at        DateTime @default(now())
  
  conversations conversations @relation(fields: [conversationid], references: [id])
}

model usages {
  id              String   @id @default(uuid()) @db.Uuid
  selectedmodel   String
  responsetime    Int
  inputtoken      Int
  outputtoken     Int
  timestamp       DateTime @default(now())
}

model files {
  id              String @id @default(uuid()) @db.Uuid
  name            String
  created_at      DateTime @default(now())
}